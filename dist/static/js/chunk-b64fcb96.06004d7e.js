(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-b64fcb96"],{"0421":function(t,e,i){},1118:function(t,e,i){"use strict";i("6777")},"395d":function(t,e,i){"use strict";i("b071")},"5f2e":function(t,e,i){"use strict";i.r(e);i("61ee");var o=i("8e44"),s=i("63c9"),n={inheritAttrs:!1,name:"",props:{height:{type:[String,Number],default:"0"},type:{type:String,require:!0}},components:{},created(){},mounted(){this.init()},data(){return{currentId:"all",editCurrent:{id:"",name:"",parent:"",type:this.type,ordernum:"0"},groupList:[{id:"all",name:"全部",children:[{id:"",name:"未分类"}]}],objById:{},visible:!1}},watch:{currentId(){this.$emit("node-click",this.currentId)}},computed:{},methods:{async init(){this.currentId="all",this.editCurrent=this.$options.data.bind(this)().editCurrent,this.groupList=this.$options.data.bind(this)().groupList;let{data:t}=await Object(o.l)({type:this.type}),{treeData:e,objById:i}=Object(s.flatToTree)(t,"id","parent");this.groupList[0].children.push(...e),this.$emit("group-list",this.groupList[0].children)},onEdit(t){this.editCurrent={...t},this.visible=!0},onAdd(t){this.editCurrent=this.$options.data.bind(this)().editCurrent,t&&"all"!=t.id&&(this.editCurrent.parent=t.id),this.visible=!0},async onRemove(t){await this.$confirm("确定要删除该分类吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"project-messagebox"}),await Object(o.h)(t.id),await this.init()},async onComfirm(){this.editCurrent.name?(this.visible=!1,await Object(o.c)(this.editCurrent),this.editCurrent.id||(this.objById[this.editCurrent.parent]?await Promise.all(this.objById[this.editCurrent.parent].children.map((async(t,e)=>{await Object(o.c)({...t,ordernum:e+1})}))):await Promise.all(this.groupList[0].children.slice(1).map((async(t,e)=>{await Object(o.c)({...t,ordernum:e+1})})))),await this.init()):this.$message.error("分类名不能为空")},onNodeClick(t){this.currentId=t.id}}},a=(i("1118"),i("e668")),r=Object(a.a)(n,(function(){var t=this,e=t._self._c;return e("moon-scroll",{staticClass:"moon-scroll",style:{height:t.height+"px"}},[e("div",{staticClass:"group"},[e("el-tree",{attrs:{"current-node-key":t.currentId,data:t.groupList,props:{children:"children",label:"name"},"highlight-current":"","node-key":"id","default-expand-all":"","check-on-click-node":"","expand-on-click-node":!1},on:{"node-click":t.onNodeClick},scopedSlots:t._u([{key:"default",fn:function({node:i,data:o}){return e("div",{staticClass:"tree-node"},[e("div",{staticClass:"tree-node-label"},[t._v(t._s(i.label))]),o.id?e("div",{staticClass:"tree-node-button"},[e("el-button",{directives:[{name:"show",rawName:"v-show",value:"all"!=o.id,expression:"data.id != 'all'"}],attrs:{type:"text",icon:"el-icon-edit",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.onEdit(o)}}}),e("el-button",{directives:[{name:"show",rawName:"v-show",value:"all"==o.id,expression:"data.id == 'all'"}],staticStyle:{color:"#67c23a"},style:"all"==o.id?{fontSize:"1.2rem"}:{},attrs:{type:"text",icon:"el-icon-circle-plus-outline",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.onAdd(o)}}}),e("el-button",{directives:[{name:"show",rawName:"v-show",value:"all"!=o.id,expression:"data.id != 'all'"}],staticStyle:{color:"red"},attrs:{type:"text",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.onRemove(o)}}})],1):t._e()])}}])}),e("moon-dialog",{staticClass:"project-dialog",attrs:{width:"400px",title:t.editCurrent.id?"编辑分类":"新增分类","append-to-body":"",visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[e("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.editCurrent.name,callback:function(e){t.$set(t.editCurrent,"name",e)},expression:"editCurrent.name"}},[e("template",{slot:"prepend"},[e("span",{staticStyle:{color:"red","margin-right":"3px"}},[t._v("*")]),t._v("分类名： ")])],2),e("div",{staticClass:"dialog-button"},[e("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.onComfirm}},[t._v("确定")])],1)],1)],1)])}),[],!1,null,"f45e46f6",null).exports,l={inheritAttrs:!1,name:"",props:{type:{type:String,require:!0},height:{type:[String,Number],default:0}},created(){},mounted(){},components:{group:r},data(){return{getProjectList:o.m,visible:!1,searchName:"",groupList:[],form:{id:"",name:"",mainWorkspaceId:"",icon:"",type:this.type,groupId:""},rules:{name:[{required:!0,message:"请填写名称",trigger:"blur"}],icon:[{required:!0,message:"请填图片地址",trigger:"blur"}]},condition:{type:this.type,groupId:void 0,name:""}}},watch:{searchName(){this.condition.name=this.searchName}},computed:{titleName(){return"project"==this.type?"项目":"组件"}},methods:{toSourceMag(){window.open("https://www.1724956493.top/moon-datav/#/moon-datav/preivew?id=d3268170c84811ed8b5e8d50fc002388")},getGroupList(t){this.groupList=t},toDocument(t){window.open(`#/md-view/moon-dv-id-${t.id}`)},toEdit(t){this.$router.push({path:"/moon-datav/create-view",query:{id:t}})},async onPublish(t){await this.$confirm(`确定发布该${this.titleName}吗?发布后将不能被修改和删除！`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"project-messagebox"}),await Object(o.b)({...t,ispublish:"1"}),this.$refs.table.getDataList(),this.$message.success("发布成功!")},toPreview(t){window.open(`#/moon-datav/preivew?id=${t}`)},onDeleteFrom(t){this.$confirm(`请确认是否删除该${this.titleName}吗?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"project-messagebox"}).then((async()=>{await Object(o.f)(t),this.$refs.table.getDataList(),this.$message.success("删除成功!")})).catch((()=>{}))},onAdd(){this.visible=!0,this.form=this.$options.data.bind(this)().form,this.form.groupId=this.condition.groupId},toUpdate(t){this.visible=!0,this.form=t},async onComfirm(){let{flag:t,fields:e}=this.$refs.form.validate_cb();if(!t)return void this.$message.error(e[Object.keys(e)[0]][0].message);this.visible=!1;const{data:i}=await Object(o.b)(this.form);this.$refs.table.getDataList()},onExit(){this.$router.replace({path:"/"})},onNodeClick(t){t="all"==t?void 0:t,this.condition.groupId=t}}},c=(i("8f3f"),{inheritAttrs:!1,name:"home",props:{},created(){},components:{projectList:Object(a.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"project-list"},[e("div",{staticClass:"group"},[e("group",{attrs:{height:t.height,type:t.type},on:{"node-click":t.onNodeClick,"group-list":t.getGroupList}})],1),e("div",{staticClass:"content"},[e("div",{staticClass:"top"},[e("div",{staticClass:"new-project",on:{click:t.onAdd}},[e("img",{attrs:{src:"dist/static/img/new-project.png",width:"100px",height:"50px",alt:""}}),t._v(" 新增"+t._s(t.titleName)+" ")]),e("el-input",{attrs:{placeholder:"搜索"+t.titleName,"prefix-icon":"el-icon-search"},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}})],1),e("moon-table-pagination",{key:"second",ref:"table",staticStyle:{width:"100%"},attrs:{condition:t.condition,dataInterface:t.getProjectList,responseType:{list:"data.list",totalCount:"data.total"},paginationPosition:["top","right"],layout:"total,  prev, pager, next ",prevText:"",nextText:""},scopedSlots:t._u([{key:"list",fn:function({listData:i}){return[e("moon-scroll",{style:{height:t.height-50+"px"}},[e("div",{staticClass:"list"},t._l(i,(function(i,o){return e("div",{key:o,staticClass:"item"},[e("div",{staticClass:"top"},[e("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:i.icon}},[e("div",{staticClass:"placeholder",attrs:{slot:"placeholder"},slot:"placeholder"},[t._v("加载中"),e("span",{staticClass:"dot"},[t._v("...")])])]),"1"==i.ispublish?e("el-tag",{staticStyle:{position:"absolute",right:"-10px",top:"-10px"},attrs:{type:"success",effect:"dark"}},[t._v(" 已发布 ")]):t._e()],1),e("div",{staticClass:"bottom"},[e("div",[t._v(t._s(i.name))]),e("div",{staticClass:"options"},[e("div",{staticClass:"btn",on:{click:function(e){return t.toDocument(i)}}},[e("i",{staticClass:"el-icon-document",attrs:{title:"文档"}})]),e("div",{staticClass:"btn",staticStyle:{"margin-left":"5px"},attrs:{title:"编辑"},on:{click:function(e){return t.toUpdate(i)}}},[e("i",{staticClass:"el-icon-edit-outline"})]),e("moon-dropdown",{staticStyle:{"margin-left":"5px"}},[e("el-button",{attrs:{type:"text"}},[t._v("更多"),e("i",{staticClass:"el-icon-arrow-down"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{on:{click:function(e){return t.toEdit(i.id)}}},[e("el-button",{attrs:{type:"text"}},[e("i",{staticClass:"el-icon-edit-outline"}),t._v(" "+t._s("1"!=i.ispublish?"设计":"查看")+" ")])],1),e("el-dropdown-item",{on:{click:function(e){return t.toPreview(i.id)}}},[e("el-button",{attrs:{type:"text"}},[e("i",{staticClass:"el-icon-view"}),t._v(" "+t._s("1"!=i.ispublish?"预览":"浏览")+" ")])],1),e("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:"1"!=i.ispublish,expression:"item.ispublish != '1'"}],on:{click:function(e){return t.onDeleteFrom(i.id)}}},[e("el-button",{attrs:{type:"text"}},[e("i",{staticClass:"el-icon-delete"}),t._v(" 删除 ")])],1),e("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:"1"!=i.ispublish,expression:"item.ispublish != '1'"}],on:{click:function(e){return t.onPublish(i)}}},[e("el-button",{attrs:{type:"text"}},[e("i",{staticClass:"el-icon-delete"}),t._v(" 发布 ")])],1)],1)],1)],1)])])})),0)])]}}])})],1),e("moon-dialog",{staticClass:"project-dialog",attrs:{width:"400px",visible:t.visible,title:(t.form.id?"修改":"新增")+t.titleName,"append-to-body":""},on:{"update:visible":function(e){t.visible=e}}},[t.visible?e("moon-form-template",{ref:"form",attrs:{span:24,model:t.form,labelWidth:"4rem",rules:t.rules}},[e("el-form-item",{attrs:{label:"名称",required:"",prop:"name"}},[e("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{attrs:{label:"图片",required:"",prop:"icon"}},[e("span",{staticStyle:{color:"#409eff",cursor:"pointer"},attrs:{slot:"label"},on:{click:t.toSourceMag},slot:"label"},[t._v("图片")]),e("el-input",{attrs:{type:"textarea"},model:{value:t.form.icon,callback:function(e){t.$set(t.form,"icon",e)},expression:"form.icon"}})],1),e("el-form-item",{attrs:{label:"分类"}},[e("el-select",{attrs:{type:"textarea","popper-class":"project-select"},model:{value:t.form.groupId,callback:function(e){t.$set(t.form,"groupId",e)},expression:"form.groupId"}},[e("el-tree",{staticStyle:{"margin-bottom":"20px"},attrs:{data:t.groupList,props:{children:"children",label:"name"},"highlight-current":"","node-key":"id","default-expand-all":"","check-on-click-node":""},scopedSlots:t._u([{key:"default",fn:function({data:t}){return e("div",{},[e("el-option",{attrs:{label:t.name,value:t.id}})],1)}}],null,!1,3209607390)})],1)],1)],1):t._e(),e("div",{staticClass:"dialog-button"},[e("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.onComfirm}},[t._v("确定")])],1)],1)],1)}),[],!1,null,"f6bd82e4",null).exports},mounted(){},directives:{resize:i("987a").a},data:()=>({contentHeight:0,activeName:"1",navList:[{id:"1",name:"项目",icon:"el-icon-monitor"},{id:"2",name:"组件",icon:"el-icon-orange"}]}),watch:{},computed:{},methods:{onExit(){this.$router.replace({path:"/"})},onMenuChange(t){this.activeName=t},onTopResize(t){let e=document.body.clientHeight;this.contentHeight=e-t.clientHeight}}}),d=(i("d344"),i("395d"),Object(a.a)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"moon-datav"},[e("div",{directives:[{name:"resize",rawName:"v-resize",value:t.onTopResize,expression:"onTopResize"}]},[e("div",{staticStyle:{color:"aliceblue",position:"absolute",right:"0"},on:{click:t.onExit}},[e("el-tooltip",{attrs:{effect:"dark",content:t.$store.state.user.userInfo.userName,placement:"bottom"}},[e("el-avatar",{attrs:{src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",size:"small"}})],1)],1),e("img",{staticStyle:{width:"100%",height:"200px"},attrs:{src:"dist/static/img/nav-img.png"}}),e("moon-menu",{staticStyle:{"margin-top":"-5px"},attrs:{"background-color":"#2e343c",hoverBgColor:"rgba(17, 17, 17,0.5)","text-color":"#fff","active-text-color":"#fff",activeBgColor:"#111111","default-active":"1",menuList:t.navList,itemStyle:{border:"none",padding:"10px 100px",fontSize:"15px"},mode:"horizontal"},on:{select:t.onMenuChange},scopedSlots:t._u([{key:"icon",fn:function({node:i}){return[i.icon?e("i",{class:i.icon,staticStyle:{"margin-right":"10px"}}):t._e()]}}])})],1),e("div",[1==t.activeName?e("projectList",{key:"project",attrs:{height:t.contentHeight,type:"project"}}):t._e(),2==t.activeName?e("projectList",{key:"component",attrs:{height:t.contentHeight,type:"component"}}):t._e()],1)])}),[],!1,null,"8ceacdd0",null));e.default=d.exports},6777:function(t,e,i){},"8f3f":function(t,e,i){"use strict";i("db61")},b071:function(t,e,i){},d344:function(t,e,i){"use strict";i("0421")},db61:function(t,e,i){}}]);